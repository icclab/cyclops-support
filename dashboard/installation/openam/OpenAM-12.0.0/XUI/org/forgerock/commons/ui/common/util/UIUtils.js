define("org/forgerock/commons/ui/common/util/UIUtils",["jquery","underscore","org/forgerock/commons/ui/common/util/typeextentions/String","org/forgerock/commons/ui/common/main/AbstractConfigurationAware","handlebars","i18next","org/forgerock/commons/ui/common/main/Router","org/forgerock/commons/ui/common/util/DateUtil"],function(e,t,n,r,i,s,o,u){var a=new r;return a.getUrl=function(){return window.location.href},a.getCurrentUrlBasePart=function(){return window.location.protocol+"//"+window.location.host},a.getCurrentHash=function(){return window.location.href.indexOf("#")===-1?"":window.location.href.substring(window.location.href.indexOf("#")+1)},a.getCurrentUrlQueryParameters=function(){var e=a.getCurrentHash(),t=window.location.search.substr(1,window.location.search.length);return e&&e.indexOf("&")>-1&&(t=e.substring(e.indexOf("&")+1)),t},a.getCurrentPathName=function(){return window.location.pathname},a.setUrl=function(e){window.location.href=e},a.normalizeSubPath=function(e){return e.endsWith("/")?e.removeLastChars():e},a.convertCurrentUrlToJSON=function(){var e={},t;return e.url=a.getCurrentUrlBasePart(),e.pathName=a.normalizeSubPath(a.getCurrentPathName()),e.params=a.convertQueryParametersToJSON(a.getCurrentUrlQueryParameters()),e},a.convertQueryParametersToJSON=function(e){return e?t.object(t.map(e.match(/([^&]+)/g),function(e){var t=e.match(/([^=]+)=?(.*)/).slice(1);return t[1]=decodeURIComponent(t[1]),t})):null},a.commonJQGridFormatters={objectFormatter:function(e,n,r){if(!e)return"";var i="<dl>",s;for(s in e)t.isString(e[s])?i+="<dt>"+s+"</dt><dd>"+e[s]+"</dd>":i+="<dt>"+s+"</dt><dd>"+JSON.stringify(e[s])+"</dd>";return i+="</dl>",i},arrayFormatter:function(e,n,r){if(!e)return"";var i="<ul>",s,o=e.length;for(s=0;s<o;s++)t.isString(e[s])?i+="<li>"+e[s]+"</li>":i+="<li>"+JSON.stringify(e[s])+"</li>";return i+="</ul>",i},dateFormatter:function(e,t,n){return e?Handlebars.helpers.date(e):""}},a.buildJQGrid=function(n,r,i,s,o){i=i?i:{};if(!r||!n||!i.url)return null;var u=n.$el.find("#"+r),a=i.colModel,f=s.storageKey,l=function(e){var t=this.jqGrid("getGridParam","colModel"),n,r=t.length,i,s,o=this.jqGrid("getGridParam","postData"),u={search:this.jqGrid("getGridParam","search"),page:this.jqGrid("getGridParam","page"),sortname:this.jqGrid("getGridParam","sortname"),sortorder:this.jqGrid("getGridParam","sortorder"),permutation:e,colStates:{}},a=u.colStates;for(n=0;n<r;n++)i=t[n],s=i.name,s!=="rn"&&s!=="cb"&&s!=="subgrid"&&(a[s]={width:i.width,hidden:i.hidden});sessionStorage.setItem(f,JSON.stringify(u))},c,h=function(t){var n,r,i=t.length,s,o,u=JSON.parse(sessionStorage.getItem(f));if(u){s=u.colStates;for(r=0;r<i;r++)n=t[r],o=n.name,o!=="rn"&&o!=="cb"&&o!=="subgrid"&&(t[r]=e.extend(!0,{},t[r],s[o]))}return u},p={datatype:"json",loadBeforeSend:function(e){e.setRequestHeader("Accept-API-Version","protocol=1.0,resource=1.0")},colNames:[],colModel:[],height:"auto",width:"none",jsonReader:{root:function(e){return e.result},total:function(e){var t=u.jqGrid("getGridParam","postData"),n=t._pagedResultsOffset+e.remainingPagedResults+e.resultCount,r=t._pageSize,i=Math.floor(n/r);return n%r>0&&(i+=1),sessionStorage.setItem(s.storageKey+"-pages-number",i),i},records:function(e){return u.jqGrid("getGridParam","postData")._pagedResultsOffset+e.remainingPagedResults+e.resultCount},userdata:function(e){return{remaining:e.remainingPagedResults}},repeatitems:!1},search:null,prmNames:{nd:null,sort:"_sortKeys",search:"_queryFilter",rows:"_pageSize"},serializeGridData:function(n){var r,i,o="",a;s.serializeGridData&&(o=s.serializeGridData.call(this,n)),a=t.pluck(u.jqGrid("getGridParam","colModel"),"name"),t.each(a,function(e,t,r){n[e]&&(o.length>0&&(o+=" AND "),o=o.concat(e,' co "',n[e],'"')),delete n[e]});if(s.searchFilter)for(r=0,i=s.searchFilter.length;r<i;r++)o.length>0&&(o+=" AND "),o=o.concat(s.searchFilter[r].field," ",s.searchFilter[r].op,' "',s.searchFilter[r].val,'"');return n._queryFilter=o===""?!0:o,n._pagedResultsOffset=n._pageSize*(n.page-1),delete n.page,n._sortKeys&&n.sord==="desc"&&(n._sortKeys="-"+n._sortKeys),delete n.sord,e.param(n)},loadComplete:function(e){t.extend(n.data[r],e)},onPaging:function(){var t=JSON.parse(sessionStorage.getItem(s.storageKey+"-pages-number")),n=e(e(this).jqGrid("getGridParam","pager")).find("input").val();if(t!==null&&/[0-9]+/.test(n)&&t<parseInt(n,10))return e(this).trigger("reloadGrid",{page:1}),"stop"},pager:null,rowNum:10,viewrecords:!0,rowList:[10,20,30]};return c=h(a),e.extend(!0,p,i),c&&e.extend(!0,p,c),u.jqGrid(p),s.search&&u.jqGrid("filterToolbar",{searchOnEnter:!1,defaultSearch:"eq"}),u.navGrid(i.pager,{edit:!1,add:!1,del:!1,search:!1,refresh:!1}).navButtonAdd(i.pager,{caption:"Columns",buttonicon:"ui-icon-add",position:"first",onClickButton:function(){u.jqGrid("columnChooser",{modal:!0,width:s.columnChooserOptions.width,height:s.columnChooserOptions.height,done:function(e){e&&l.call(this,e),u.trigger("jqGridAfterLoadComplete.setFrozenColumns")}})}}),u.on("jqGridAfterGridComplete",function(){o&&o()}),u.on("jqGridAfterLoadComplete.setFrozenColumns",function(){var t=n.$el.find("#"+r),i,s;n.$el.find("#"+r+"_frozen").find("tr").each(function(){e.jgrid.jqID(this.id)&&(i=t.find("#"+e.jgrid.jqID(this.id)),s=i.outerHeight(),e(this).find("td").height(s),i.find("td").height(s))})}),u},a.templates={},a.renderTemplate=function(e,t,n,r,i,s){a.fillTemplateWithData(e,n,function(e){if(s&&!s())return!1;i==="append"?t.append(e):t.html(e),r&&r()})},a.fillTemplateWithData=function(t,n,r){if(t){if(a.templates[t]){var i=Handlebars.compile(a.templates[t])(n);return r&&r(i),i}e.ajax({type:"GET",url:t,dataType:"html",success:function(e){n==="unknown"||n===null?r&&r(e):(a.templates[t]=e,r&&r(Handlebars.compile(e)(n)))},error:r})}},a.reloadTemplate=function(t){e.ajax({type:"GET",url:t,dataType:"html",success:function(e){a.templates[t]=e}})},a.preloadTemplates=function(){var e;for(e in a.configuration.templateUrls)a.reloadTemplate(a.configuration.templateUrls[e])},e.fn.emptySelect=function(){return this.each(function(){this.tagName==="SELECT"&&(this.options.length=0)})},e.fn.loadSelect=function(e){return this.emptySelect().each(function(){if(this.tagName==="SELECT"){var t,n,r=this;for(t=0;t<e.length;t++)n=new Option(e[t].value,e[t].key),r.options[r.options.length]=n}})},e.event.special.delayedkeyup={setup:function(t,n){e(this).bind("keyup",e.event.special.delayedkeyup.handler)},teardown:function(t){e(this).unbind("keyup",e.event.special.delayedkeyup.handler)},handler:function(t){var n=this,r=arguments;t.type="delayedkeyup",e.doTimeout("delayedkeyup",250,function(){e.event.handle.apply(n,r)})}},Handlebars.registerHelper("t",function(e){var n={postProcess:"sprintf",sprintf:t.map(t.toArray(arguments).slice(1,-1),Handlebars.Utils.escapeExpression)},r;return r=i18n.t(e,n),new Handlebars.SafeString(r)}),Handlebars.registerHelper("url",function(e){var n="#"+o.getLink(o.configuration.routes[e],t.toArray([arguments[1]]));return n}),Handlebars.registerHelper("date",function(e,n){var r=u.parseDateString(e),i;return u.isDateValid(r)?(n&&t.isString(n)?i=u.formatDate(r,n):i=u.formatDate(r),new Handlebars.SafeString(i)):""}),Handlebars.registerHelper("selectm",function(n,r,i,s,o,u){var a,f,l,c="",h,p;f="<select",r&&t.isString(r)&&(f+=' name="'+r+'"'),o&&(f+=' multiple="multiple"'),u&&(f+=' style="height: '+u+'px"'),f+=">",l="</select> ";for(p in n)h=!1,s&&t.isString(s)?s===n[p]&&(h=!0):i&&i===p&&(h=!0),h?c+='<option value="'+p+'" selected="true">'+e.t(n[p])+"</option>":c+='<option value="'+p+'">'+e.t(n[p])+"</option>";return a=f+c+l,new Handlebars.SafeString(a)}),Handlebars.registerHelper("staticSelect",function(t,n){var r=e("<select />").html(n.fn(this));return r.find("[value="+t+"]").attr({selected:"selected"}),r.html()}),Handlebars.registerHelper("select",function(n,r,i,s,o){var u,a,f,l="",c,h,p;n&&t.isString(n)&&(n=JSON.parse(n)),r&&t.isString(r)?a='<select name="'+r+'" '+o+">":a="<select>",f="</select> ";for(h in n)c=!1,s&&t.isString(s)&&s!==""?s===n[h]&&(c=!0):i&&i!==""&&i===h&&(c=!0),h==="__null"?p="":p=h,c?l+='<option value="'+p+'" selected="true">'+e.t(n[h])+"</option>":l+='<option value="'+p+'">'+e.t(n[h])+"</option>";return u=a+l+f,new Handlebars.SafeString(u)}),Handlebars.registerHelper("p",function(e,t){var n,r;return n={count:e},r=i18n.t(t.hash.key,n),new Handlebars.SafeString(r)}),Handlebars.registerHelper("equals",function(e,t,n){if(e===t)return n.fn(this)}),Handlebars.registerHelper("checkbox",function(e,n,r){var i="<div class='checkboxList' id='"+n+"'><ol>",s,o=t.chain(e).pairs().sortBy(function(e){return e[1]}).value();for(s=0;s<o.length;s++)i+='<li><input type="checkbox" name="'+n+'" value="'+o[s][0]+'" id="'+n+"_"+encodeURIComponent(o[s][0])+'"><label for="'+n+"_"+encodeURIComponent(o[s][0])+'">'+o[s][1]+"</label></li>";return i+="</ol></div>",new Handlebars.SafeString(i)}),Handlebars.registerHelper("siteImages",function(e,t){var n="",r;for(r=0;r<e.length;r++)n+='<img class="item" src="'+encodeURI(e[r])+'" data-site-image="'+encodeURI(e[r])+'" />';return new Handlebars.SafeString(n)}),Handlebars.registerHelper("each_with_index",function(e,t){var n="",r,i=0,s=0,o=0;for(s=0,o=e.length;s<o;s++)e[s]&&(r={},r.value=e[s],r.index=i,r.first=i===0,r.last=i===e.length,n+=t.fn(r),i++);return n}),Handlebars.registerHelper("camelCaseToTitle",function(e){var t=e.replace(/([a-z])([A-Z])/g,"$1 $2");return new Handlebars.SafeString(t[0].toUpperCase()+t.slice(1))}),Handlebars.registerHelper("stringify",function(e,t){t=t?t:0;var n=JSON.stringify(e,null,t);return n}),Handlebars.registerHelper("ifObject",function(e,t){return typeof e=="object"?t.fn(this):t.inverse(this)}),a.loadSelectOptions=function(t,n,r,i){if(r===undefined||r===!0)t=[{key:"",value:e.t("common.form.pleaseSelect")}].concat(t);n.loadSelect(t),i&&i(t)},a.jqConfirm=function(n,r,i){var s={};s[e.t("common.form.cancel")]=function(){e("#jqConfirm").dialog("close")},s[e.t("common.form.ok")]=function(){e("#jqConfirm").dialog("close"),r()},t.isUndefined(i)&&(i="550px"),e('<div id="jqConfirm">'+n+"</div>").dialog({title:e.t("common.form.confirm"),modal:!0,resizable:!1,bgiframe:!0,width:i,buttons:s,close:function(){e("#jqConfirm").dialog("destroy").remove()}})},a.responseMessageMatch=function(e,t){var n=JSON.parse(e).message;return n.indexOf(t)>-1},t.mixin({findByValues:function(e,n,r){return t.filter(e,function(e){return t.contains(r,e[n])})},removeByValues:function(e,n,r){return t.reject(e,function(e){return t.contains(r,e[n])})}}),a})